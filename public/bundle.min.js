!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){{var c=a("./CostAlgorithmParameters.js"),d=a("./CostAlgorithmHelpers.js"),e=function(a,b,e,f,g){var h=a.toString()+","+b.toString()+","+e.toString()+","+f.toString(),i=Math.abs(b-a),j=d.fingerDistance(e,f);if(Math.abs(b-a)>0&&f-e===0)g[h]=d.ascMoveFormula(i,j,a,b);else if(b-a>=0&&0>f-e&&1!==f)g[h]=d.ascMoveFormula(i,j,a,b,e,f);else if(0>b-a&&f-e>0&&1!==e)g[h]=d.ascMoveFormula(i,j,a,b,e,f);else if(b-a>=0&&0>f-e&&1===f)g[h]=d.ascThumbCost(i,j,a,b,e,f);else if(0>b-a&&1===e&&1!==f)g[h]=d.descThumbCost(i,j,a,b,e,f);else{var k=d.fingerStretch(e,f),l=Math.abs(i-j)/k;g[h]=l>c.moveCutoff?d.descMoveFormula(i,j,a,b,e,f):d.ascDescNoCrossCost(i,j,l,a,b,e,f)}};b.exports.createCostDatabase=function(){for(var a={},b=1;5>=b;b++)for(var c=21;109>c;c++)for(var d=1;5>=d;d++)for(var f=21;109>f;f++)e(c,f,b,d,a);return a}}},{"./CostAlgorithmHelpers.js":2,"./CostAlgorithmParameters.js":3}],2:[function(a,b){var c=a("./CostAlgorithmParameters.js"),d=b.exports,e=function(a){return.0002185873295*Math.pow(a,7)-.008611946279*Math.pow(a,6)+.1323250066*Math.pow(a,5)-1.002729677*Math.pow(a,4)+3.884106308*Math.pow(a,3)-6.723075747*Math.pow(a,2)+1.581196785*a+7.711241722},f=function(a,b,d,e,f){if("White"===c.color[a%12]&&"Black"===c.color[b%12]){if(5===e||1===e)return 4;if(0===f)return 4}if("Black"===c.color[a%12]&&"White"===c.color[b%12]){if(5===d||1===d)return 4;if(0===f)return-1}return 0},g=d.ascMoveFormula=function(a,b,d,e,g,h){var i,j=Math.ceil(a+b);return j>24?c.moveHash[24]+(j-24)/5:(i=c.moveHash[j],i+=f(d,e,g,h,b))};d.descMoveFormula=function(a,b,d,e,g,h){var i,j=Math.ceil(a-b);return j>24?c.moveHash[24]+(j-24)/5:(i=c.moveHash[j],i+=f(d,e,g,h,b))},d.fingerDistance=function(a,b){var d=a.toString()+","+b.toString();return c.fingDistance[d]},d.ascThumbCost=function(a,b,d,f,h,j){var k=i(h,j),l=(a+b)/k;if(l>10)return g(a,b);var m=e(l);return"White"===c.color[d%12]&&"Black"===c.color[f%12]&&(m+=8),m},d.descThumbCost=function(a,b,d,f,i,j){var k=h(i,j),l=(a+b)/k;if(l>10)return g(a,b);var m=e(l);return"Black"===c.color[d%12]&&"White"===c.color[f%12]&&(m+=8),m};var h=d.descThumbStretch=function(a,b){var d=a.toString()+","+b.toString();return c.descThumbStretchVals[d]},i=d.ascThumbStretch=function(a,b){var d=a.toString()+","+b.toString();return c.ascThumbStretchVals[d]};d.fingerStretch=function(a,b){var d=a.toString()+","+b.toString();return c.fingStretch[d]},d.ascDescNoCrossCost=function(a,b,d,e,g,h,i){var j,k=function(a){return-6.589793725e-7*Math.pow(a,10)-2336381414e-15*Math.pow(a,9)+9925769823e-14*Math.pow(a,8)+.0001763353131*Math.pow(a,7)-.004660305277*Math.pow(a,6)-.004290746384*Math.pow(a,5)+.06855725903*Math.pow(a,4)+.03719817227*Math.pow(a,3)+.4554696705*Math.pow(a,2)-.08305450359*a+.3020594956};return d>6.8&&d<=c.moveCutoff?k(6.8)+3*(d-6.8):(j=k(d),j+=f(e,g,h,i))}},{"./CostAlgorithmParameters.js":3}],3:[function(a,b){var c=b.exports;c.moveCutoff=7.5,c.color={0:"White",1:"Black",2:"White",3:"Black",4:"White",5:"White",6:"Black",7:"White",8:"Black",9:"White",10:"Black",11:"White"},c.fingDistance={"1,1":0,"1,2":2,"1,3":3.5,"1,4":5,"1,5":7,"2,1":2,"2,2":0,"2,3":2,"2,4":3.5,"2,5":5,"3,1":3.5,"3,2":2,"3,3":0,"3,4":2,"3,5":3.5,"4,1":5,"4,2":3.5,"4,3":2,"4,4":0,"4,5":2,"5,1":7,"5,2":5,"5,3":3.5,"5,4":2,"5,5":0};var d=c.makeMoveHash=function(a){var b={1:0,2:.5,3:1.8,4:3,5:5,6:7,7:8,8:8.9,9:9.7,10:10.5,11:11,12:11.4,13:11.8,14:12.2,15:12.5,16:12.8,17:13.1,18:13.4,19:13.7,20:14,21:14.3,22:14.6,23:14.9,24:15.2};for(var c in b)b[c]+=a;return b};c.moveHash=d(4),c.descThumbStretchVals={"1,2":1,"1,3":1,"1,4":.9,"1,5":.95},c.ascThumbStretchVals={"2,1":.95,"3,1":1,"4,1":.95,"5,1":.95},c.fingStretch={"1,1":.8,"1,2":1.15,"1,3":1.4,"1,4":1.45,"1,5":1.6,"2,1":1.15,"2,2":.6,"2,3":.9,"2,4":1.15,"2,5":1.3,"3,1":1.4,"3,2":.9,"3,3":.6,"3,4":.9,"3,5":1.15,"4,1":1.45,"4,2":1.15,"4,3":.9,"4,4":.7,"4,5":.7,"5,1":1.6,"5,2":1.3,"5,3":1.15,"5,4":.8,"5,5":.6}},{}],4:[function(a,b){var c=a("./FingeringAlgorithmHelpers.js");b.exports.FingeringAlgorithm=function(a){for(var b=c.addStartTimes(a),d=0;d<app.preComputed.length;d++)if(app.preComputed[d].title===app.currentSong){var e=app.preComputed[d].BestPathObj;return void c.distributePath(e,b)}for(var f=c.makeNoteTrellis(b),g=1;g<f.length;g++)for(var h=0;h<f[g].length;h++)for(var i=1/0,j=0;j<f[g-1].length;j++){var k=f[g][h],l=f[g-1][j],m=l.nodeScore||0,n=c.getSplitData(k),o=c.getSplitData(l),p=n.right,q=o.right;if(p.notes.length>0)for(var r=2,s=l;0===q.notes.length;){var t=s.bestPrev,u=f[g-r][t];q=c.getSplitData(u).right,r++,s=u}var v=n.left,w=o.left;if(v.notes.length>0)for(var r=2,s=l;0===w.notes.length;){var t=s.bestPrev,u=f[g-r][t];w=c.getSplitData(u).left,r++,s=u}var x=c.calcCost(p,q,v,"RH"),y=c.calcCost(v,w,p,"LH");m+=x+y,i>m&&(i=m,k.nodeScore=m,k.bestPrev=j)}for(var z=c.findMin(f[f.length-1]),A={},B=f.length-1;B>0;B--){for(var C=f[B][z],D=C.fingers,E=C.notes,F=0;F<E.length;F++){var G=E[F][0],H=E[F][1],I=D[F],J=G+","+H;A[J]=I}z=C.bestPrev}c.distributePath(A,b)}},{"./FingeringAlgorithmHelpers.js":5}],5:[function(a,b){var c=a("./CostAlgorithm.js").createCostDatabase(),d=a("./LHCostAlgorithm.js").createLHCostDatabase(),e=b.exports;e.notes={0:"C",1:"C#",2:"D",3:"Eb",4:"E",5:"F",6:"F#",7:"G",8:"G#",9:"A",10:"Bb",11:"B"};for(var f=function(a){var b=[],c=[-5,-4,-3,-2,-1,1,2,3,4,5],d=function(a,c,e){if(c.length===a)return void b.push(c.slice());for(var f=0;f<e.length;f++){c.push(e[f]);var g=c,h=e.slice();h.splice(0,f+1),d(a,g,h),c.pop()}};return d(a,[],c),b},g={},h=1;10>=h;h++)g[h]=f(h);var i=[{notes:["e","e"],fingers:[1,-1]}],j=function(a,b){this.notes=a,this.fingers=b,this.nodeScore=0,this.bestPrev=void 0},k=function(a){for(var b=a.sort(function(a,b){return a[0]-b[0]}),c=[],d=g[b.length],e=0;e<d.length;e++){var f=d[e],h=new j(b,f);c.push(h)}return c},l=function(a,b){for(var c=0;c<a.length;c++)if(a[c][0]===b)return c};e.makeNoteTrellis=function(a){var b=[],c=!1,d=[];d.push(i);for(var e=0;e<a.length;e++){var f,g,h=a[e][0].event,j=h.noteNumber;if("noteOn"===h.subtype){var m=h.startTime;b.push([j,m]),c=!0}"noteOff"===h.subtype&&(c?(f=k(b.slice()),d.push(f),g=l(b,j),b.splice(g,1),c=!1):(g=l(b,j),b.splice(g,1),c=!1))}return d};var m=function(a,b,d,e){if("e"===a||"e"===b)return 0;var f=a+","+b+","+d+","+e,g=c[f],h=60-b;return g+=h>0?h:0},n=function(a,b,c,e){if("e"===a||"e"===b)return 0;c=Math.abs(c),e=Math.abs(e);var f=a+","+b+","+c+","+e,g=d[f],h=b-60;return g+=h>0?h:0};e.findMin=function(a){for(var b,c=1/0,d=0;d<a.length;d++)a[d].nodeScore<c&&(c=a[d].nodeScore,b=d);return b},e.distributePath=function(a,b){var c={};for(var d in a)a[d]=+a[d];for(var e=0;e<b.length;e++){var f=b[e][0].event,g=f.noteNumber;if("noteOn"===f.subtype){var h=f.startTime,i=g+","+h,j=a[i];f.finger=j,c[g]=j}"noteOff"===f.subtype&&(f.finger=c[g])}},e.addStartTimes=function(a){for(var b=0,c=0;c<a.length;c++){var d=a[c][0].event;"noteOff"===d.subtype?b+=d.deltaTime:"noteOn"===d.subtype&&(d.startTime=b,b+=d.deltaTime)}return a},e.getSplitData=function(a){for(var b={right:{notes:[],fingers:[]},left:{notes:[],fingers:[]}},c=0;c<a.fingers.length;c++)a.fingers[c]>0?(b.right.fingers.push(a.fingers[c]),b.right.notes.push(a.notes[c])):(b.left.fingers.push(a.fingers[c]),b.left.notes.push(a.notes[c]));return b},e.calcCost=function(a,b,c,d){for(var e="RH"===d?m:n,f=0,g=0;g<a.notes.length;g++){var h=a.notes[g][0],i=a.fingers[g],j=a.notes[g+1]||!1,k=a.fingers[g+1];f+=j?e(h,j[0],i,k):"RH"===d?60-h:h-60;for(var l=0;l<b.notes.length;l++){var o=b.notes[l][0],p=b.fingers[l],q=e(o,h,p,i);f+=q}}return f}},{"./CostAlgorithm.js":1,"./LHCostAlgorithm.js":6}],6:[function(a,b){{var c=a("./CostAlgorithmParameters.js"),d=a("./CostAlgorithmHelpers.js"),e=function(a,b,e,f,g){var h=a.toString()+","+b.toString()+","+e.toString()+","+f.toString(),i=Math.abs(b-a),j=d.fingerDistance(e,f);if(i>0&&f-e===0)g[h]=d.ascMoveFormula(i,j,a,b);else if(0>=b-a&&0>f-e&&1!==f)g[h]=d.ascMoveFormula(i,j);else if(b-a>0&&f-e>0&&1!==e)g[h]=d.ascMoveFormula(i,j);else if(0>=b-a&&0>f-e&&1===f)g[h]=d.ascThumbCost(i,j,a,b,e,f);else if(b-a>=0&&1===e&&1!==f)g[h]=d.descThumbCost(i,j,a,b,e,f);else{var k=d.fingerStretch(e,f),l=Math.abs(i-j)/k;g[h]=l>c.moveCutoff?d.descMoveFormula(i,j):d.ascDescNoCrossCost(i,j,l,a,b,e,f)}};b.exports.createLHCostDatabase=function(){for(var a={},b=1;5>=b;b++)for(var c=21;109>c;c++)for(var d=1;5>=d;d++)for(var f=21;109>f;f++)e(c,f,b,d,a);return a}}},{"./CostAlgorithmHelpers.js":2,"./CostAlgorithmParameters.js":3}],7:[function(a,b){var c=a("./Visuals/Piano/KeyboardDesign.js").KeyboardDesign,d=a("./Visuals/Piano/Keyboard.js").Keyboard,e=a("./Visuals/Hands/Right/RightHand.js").RightHand,f=a("./Visuals/Hands/Left/LeftHand.js").LeftHand,g=a("./Visuals/Scene.js").Scene,h=(a("./Algorithms/CostAlgorithm").createCostDatabase,a("./Algorithms/FingeringAlgorithm.js").FingeringAlgorithm),i=a("./PlayControls.js").PlayControls;b.exports.App=function(){this.keyboardDesign=new c,this.keyboard=new d(this.keyboardDesign),this.rightHand=new e(this.keyboard),this.leftHand=new f(this.keyboard),this.player=MIDI.Player;var a=this;this.player.addListener(function(b){var c=a.rightHand,d=a.leftHand,e=144,f=128,g=b.note,h=b.message,i=b.finger;h===e?(a.keyboard.press(g),i>0?c.press(i,g):d.press(i,g)):h===f&&(a.keyboard.release(g),i>0?c.release(i):d.release(i))}),this.player.setAnimation({delay:20,callback:function(b){var c=b.now,d=b.end;a.playControls.displayProgress(c,d)}}),this.loadMidiFile=function(a,b){var c=this;this.player.loadFile(a,function(){c.playControls.setCurrentTime(b)})},this.upload=function(a){var b=this,c=new FileReader;c.onload=function(a){var c=a.target.result;b.loadMidiFile(c)},c.readAsDataURL(a)},this.initScene=function(){var a=this;this.scene=new g("#canvas"),this.scene.add(this.keyboard.model),this.scene.add(this.rightHand.model),this.scene.add(this.leftHand.model),this.scene.animate(function(){a.keyboard.update(),a.rightHand.update(),a.leftHand.update(),TWEEN.update()})},this.initMIDI=function(a){MIDI.loadPlugin(function(){MIDI.channels[9].mute=!0,"function"==typeof a&&a()})},this.initPlayControls=function(b,c){a.playControls=new i(b,c)},this.fingeringAlgorithm=function(){h(a.player.data)}}},{"./Algorithms/CostAlgorithm":1,"./Algorithms/FingeringAlgorithm.js":4,"./PlayControls.js":9,"./Visuals/Hands/Left/LeftHand.js":14,"./Visuals/Hands/Right/RightHand.js":20,"./Visuals/Piano/Keyboard.js":26,"./Visuals/Piano/KeyboardDesign.js":27,"./Visuals/Scene.js":29}],8:[function(a){var b=a("./App.js").App;$(document).on("ready",function(){var a=window.app=new b;a.initMIDI(function(){a.initScene(),$.ajax({url:"/getAllPaths",dataType:"json",success:function(b){a.preComputed=b,a.initPlayControls($(".main-container"),a),$($(".player-songList > li")[0]).trigger("click")}})})})},{"./App.js":7}],9:[function(a,b){b.exports.PlayControls=function(a,b){var c=($(a),$(".player-songListContainer"),$(".player-controls"),$(".player-progress-container")),d=$(".player-progress-bar"),e=($(".player-progress-text"),$(".player-songList")),f=($(".song"),$(".tempo-changer")),g=$(".player-playBtn"),h=$(".player-pauseBtn"),i=$(".current-song"),j=this;this.play=function(){g.hide(),h.show(),j.playing=!0,b.player.resume()},this.playHandler=function(){j.playing===!1?j.resume():j.play()},this.pauseHandler=function(){j.pause()},this.songListHandler=function(a){var c=$(a.target),d=c.text();i.text(d),j.playing=!1,b.currentSong=d,$.ajax({url:"/songs/"+d,dataType:"text",success:function(a){b.loadMidiFile(a,0)}})},this.resume=function(){g.hide(),h.show(),b.player.currentTime+=1e-6,j.playing=!0,b.player.resume()},this.stop=function(){b.player.stop(),j.playing=!1},this.progressHandler=function(a){var b=(a.clientX-c.offset().left)/c.width();j.setCurrentTime(b)},this.tempoHandler=function(a){var e=$(a.target),f=e.find("input").attr("data-timeWarp");b.player.timeWarp=f;var g=b.currentSong;$.ajax({url:"/songs/"+g,dataType:"text",success:function(a){var e=d.width()/c.width();b.loadMidiFile(a,e)}})},this.pause=function(){j.playing=!1,g.show(),h.hide(),b.player.pause(),j.resume()},this.getEndTime=function(){return b.player.endTime},this.displayProgress=function(a,b){var e=a/b,f=Math.floor(e*c.width());d.width(f)},this.setCurrentTime=function(a){var c=b.player.endTime*a;b.player.currentTime=c,setTimeout(j.resume,10),b.player.pause()},g.on("click",j.playHandler),h.on("click",j.pauseHandler),e.on("click",j.songListHandler),c.on("click",j.progressHandler),f.on("click",j.tempoHandler)}},{}],10:[function(a,b){b.exports.Dummy=function(){var a=new THREE.CubeGeometry(1,1,1),b=new THREE.MeshLambertMaterial({color:0}),c=new THREE.Vector3(0,0,0);this.model=new THREE.Mesh(a,b),this.model.position.copy(c),this.model.visible=!1}},{}],11:[function(a,b){var c=a("./FingerMoveParams.js").params;b.exports.Finger=function(a){var b=.6;this.originalY=.2,this.pressedY=this.originalY-b,this.releaseSpeed=.05,this.moveSpeed=.1;var d=a;this.distances=c(d),this.press=function(a){this.moveToNote(a),this.model.position.y=this.pressedY,this.isPressed=!0},this.release=function(){this.isPressed=!1},this.moveToNote=function(a){this.currentPos.x=this.model.position.x,this.currentPos.y=this.model.position.y,this.currentPos.z=this.model.position.z;var b=this.model.parent.children[this.number+1].currentNote,c=this.model.parent.children[this.number-1].currentNote;a>this.model.currentNote?this.model.currentNote=b===a?a-1:a:a<this.model.currentNote&&(this.model.currentNote=c===a?a+1:a),this.setNewPos(this.model.currentNote),this.setUpNewTween()},this.update=function(){if(this.model.position.y<this.originalY&&this.isPressed===!1){var a=this.originalY-this.model.position.y;this.model.position.y+=Math.min(a,this.releaseSpeed)}},this.currentPos={x:0,y:0,z:0},this.newPos={x:0,y:0,z:0},this.setNewPos=function(a){this.newPos.x=d.model.children[a-21].position.x,this.newPos.y=d.keys[a].model.position.y+this.originalY,this.newPos.z=d.keys[a].model.position.z+.5},this.setUpNewTween=function(){var a=this,b=function(){a.model.position.x=a.currentPos.x,a.model.position.y=a.currentPos.y+.1,a.model.position.z=a.currentPos.z},c=TWEEN.Easing.Quadratic.Out,d=new TWEEN.Tween(this.currentPos).to(this.newPos,150).easing(c).onUpdate(b);d.start()},this.setUpPressReleaseTween=function(){}}},{"./FingerMoveParams.js":12}],12:[function(a,b){b.exports.params=function(a){var b={};return b.get=function(b,c){return a.model.children[c-21].position.x-a.model.children[b-21].position.x},b}},{}],13:[function(a,b){b.exports.HandDesign=function(a){this.pinkyWidth=.14,this.pinkyHeight=.1,this.pinkyLength=.57,this.pinkyColor=16711680,this.ringFingerWidth=.18,this.ringFingerHeight=.1,this.ringFingerLength=.61,this.ringFingerColor=26112,this.middleFingerWidth=.185,this.middleFingerHeight=.1,this.middleFingerLength=.7,this.middleFingerColor=13311,this.indexFingerWidth=.188,this.indexFingerHeight=.1,this.indexFingerLength=.6,this.indexFingerColor=16776960,this.thumbWidth=.175,this.thumbHeight=.1,this.thumbLength=.5,this.thumbColor=16724991,this.keyboard=a,this.keyboardHeight=.22}},{}],14:[function(a,b){var c=a("./LeftPinky.js").LeftPinky,d=a("./LeftRing.js").LeftRing,e=a("./LeftMiddle.js").LeftMiddle,f=a("./LeftIndex.js").LeftIndex,g=a("./LeftThumb.js").LeftThumb,h=a("../HandDesign.js").HandDesign,i=a("../Dummy.js").Dummy;b.exports.LeftHand=function(a){var b=this,j=new h(a),k=new c(j,"left"),l=new d(j,"left"),m=new e(j,"left"),n=new f(j,"left"),o=new g(j,"left"),p=new i,q=new i;this.fingers=[],this.model=new THREE.Object3D,this.fingers.push(void 0),this.model.add(p.model),p.model.currentNote=-1,this.model.add(o.model),this.fingers.push(o),o.model.currentNote=1,this.model.add(n.model),this.fingers.push(n),n.model.currentNote=1,this.model.add(m.model),this.fingers.push(m),m.model.currentNote=1,this.model.add(l.model),this.fingers.push(l),l.model.currentNote=1,this.model.add(k.model),this.fingers.push(k),k.model.currentNote=1,this.model.add(q.model),q.model.currentNote=110,o.moveToNote(55),n.moveToNote(53),m.moveToNote(52),l.moveToNote(50),k.moveToNote(48),this.model.position.y-=.11,this.model.traverse(function(a){a.position.x-=4.45}),this.offSet=.2222,this.press=function(c,d){c=Math.abs(c);for(var e=a.keys[d].model.position.x,f=1;5>=f;f++)f===c?b.fingers[f].press(d):b.fingers[f].moveAsNeeded(c,e,d)},this.release=function(a){a=Math.abs(a),b.fingers[a].release()},this.update=function(){for(var a=b.fingers,c=1;c<a.length;c++)a[c].update()}}},{"../Dummy.js":10,"../HandDesign.js":13,"./LeftIndex.js":15,"./LeftMiddle.js":16,"./LeftPinky.js":17,"./LeftRing.js":18,"./LeftThumb.js":19}],15:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.LeftIndex=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.indexFingerWidth,a.indexFingerHeight,a.indexFingerLength),d=new THREE.MeshLambertMaterial({color:a.indexFingerColor}),e=new THREE.Vector3(0,.2,.4);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=2;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 4:this.ringRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){a>=f.get(c,c-8)&&a<=f.get(c,c-4)||this.moveToNote(d+5)},this.ringRules=function(a,b,c,d){a>=f.get(c,c-6)&&a<=f.get(c,c-4)||this.moveToNote(d+3)},this.middleRules=function(a,b,c,d){a>=f.get(c,c-5)&&a<=f.get(c,c-1)||this.moveToNote(d+4)},this.thumbRules=function(a,b,c,d){if(!(a>0&&a<=f.get(c,c+4)))if(a>f.get(c,c-3)&&0>a){var e=this;setTimeout(e.moveToNote(d-2),100)}else this.moveToNote(d-2)}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],16:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.LeftMiddle=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.middleFingerWidth,a.middleFingerHeight,a.middleFingerLength),d=new THREE.MeshLambertMaterial({color:a.middleFingerColor}),e=new THREE.Vector3(0,.2,.4);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=3;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 4:this.ringRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){a>f.get(c,c-5)&&a<f.get(c,c-3)||this.moveToNote(d+3)},this.ringRules=function(a,b,c,d){a>f.get(c,c-4)&&a<f.get(c,c-1)||this.moveToNote(d+2)},this.indexRules=function(a,b,c,d){a>0&&a<f.get(c,c+3)||this.moveToNote(d-2)},this.thumbRules=function(a,b,c,d){if(!(a>0&&a<f.get(c,c+6)))if(a>f.get(c,c-4)&&0>a){var e=this;setTimeout(e.moveToNote(d-3),100)}else this.moveToNote(d-3)}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],17:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.LeftPinky=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.pinkyWidth,a.pinkyHeight,a.pinkyLength),d=new THREE.MeshLambertMaterial({color:a.pinkyColor}),e=new THREE.Vector3(0,.2,.54);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=5;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 4:this.ringRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.ringRules=function(a,b,c,d){a>0&&a<=f.get(c,c+3)||this.moveToNote(d-2)},this.middleRules=function(a,b,c,d){a>0&&a<=f.get(c,c+5)||this.moveToNote(d-3)},this.indexRules=function(a,b,c,d){a>0&&a<=f.get(c,c+7)||this.moveToNote(d-5)},this.thumbRules=function(a,b,c,d){if(!(a>0&&a<=f.get(c,c+12)))if(a>0&&a<=f.get(c,c+1)){var e=this;setTimeout(e.moveToNote(d-7),100)}else this.moveToNote(d-7)},this.setUpNewTween=function(){var a=this,b=function(){a.model.position.x=a.currentPos.x,a.model.position.y=a.currentPos.y+.1,a.model.position.z=a.currentPos.z+.1},c=TWEEN.Easing.Quadratic.Out,d=new TWEEN.Tween(this.currentPos).to(this.newPos,150).easing(c).onUpdate(b);d.start()}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],18:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.LeftRing=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.ringFingerWidth,a.ringFingerHeight,a.ringFingerLength),d=new THREE.MeshLambertMaterial({color:a.ringFingerColor}),e=new THREE.Vector3(0,.2,.45);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=4;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){a>f.get(c,c-3)&&a<f.get(c,c-2)||this.moveToNote(d+2)},this.middleRules=function(a,b,c,d){a>0&&a<f.get(c,c+3)||this.moveToNote(d-2)},this.indexRules=function(a,b,c,d){a>0&&a<f.get(c,c+5)||this.moveToNote(d-3)},this.thumbRules=function(a,b,c,d){if(!(a>0&&a<f.get(c,c+8)))if(a>f.get(c,c-2)&&0>a){var e=this;setTimeout(e.moveToNote(d-5),100)}else this.moveToNote(d-5)}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],19:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.LeftThumb=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.thumbWidth,a.thumbHeight,a.thumbLength),d=new THREE.MeshLambertMaterial({color:a.thumbColor}),e=new THREE.Vector3(0,.3,.6);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=1;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 4:this.ringRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){if(!(a>=f.get(c,c-12)&&a<=f.get(c,c-5)))if(a>0&&a<f.get(c,c+1)){var e=this;setTimeout(e.moveToNote(d+7),100)}else this.moveToNote(d+7)},this.ringRules=function(a,b,c,d){if(!(a>=f.get(c,c-9)&&a<=f.get(c,c-4)))if(a>0&&a<f.get(c,c+2)){var e=this;setTimeout(e.moveToNote(d+5),100)}else this.moveToNote(d+5)},this.middleRules=function(a,b,c,d){if(!(a>=f.get(c,c-7)&&a<=f.get(c,c-2)))if(a>0&&a<f.get(c,c+4)){var e=this;setTimeout(e.moveToNote(d+4),100)}else this.moveToNote(d+4)},this.indexRules=function(a,b,c,d){if(!(a>=f.get(c,c-4)&&0>a))if(a>0&&a<f.get(c,c+2)){var e=this;setTimeout(e.moveToNote(d+2),100)}else this.moveToNote(d+2)},this.setUpNewTween=function(){var a=this,b=function(){a.model.position.x=a.currentPos.x,a.model.position.y=a.currentPos.y+.1,a.model.position.z=a.currentPos.z+.2},c=TWEEN.Easing.Quadratic.Out,d=new TWEEN.Tween(this.currentPos).to(this.newPos,150).easing(c).onUpdate(b);d.start()}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],20:[function(a,b){var c=a("./RightPinky.js").RightPinky,d=a("./RightRing.js").RightRing,e=a("./RightMiddle.js").RightMiddle,f=a("./RightIndex.js").RightIndex,g=a("./RightThumb.js").RightThumb,h=a("../HandDesign.js").HandDesign,i=a("../Dummy.js").Dummy;b.exports.RightHand=function(a){var b=this,j=new h(a),k=new c(j,"right"),l=new d(j,"right"),m=new e(j,"right"),n=new f(j,"right"),o=new g(j,"right"),p=new i,q=new i;this.fingers=[],this.model=new THREE.Object3D,this.fingers.push(void 0),this.model.add(p.model),p.model.currentNote=-1,this.model.add(o.model),this.fingers.push(o),o.model.currentNote=5,this.model.add(n.model),this.fingers.push(n),n.model.currentNote=1,this.model.add(m.model),this.fingers.push(m),m.model.currentNote=1,this.model.add(l.model),this.fingers.push(l),l.model.currentNote=1,this.model.add(k.model),this.fingers.push(k),k.model.currentNote=1,this.model.add(q.model),q.model.currentNote=110,o.moveToNote(60),n.moveToNote(62),m.moveToNote(64),l.moveToNote(65),k.moveToNote(67),this.model.position.y-=.11,this.model.traverse(function(a){a.position.x-=4.45}),this.press=function(c,d){for(var e=a.keys[d].model.position.x,f=1;5>=f;f++)f===c?b.fingers[f].press(d):b.fingers[f].moveAsNeeded(c,e,d)},this.release=function(a){b.fingers[a].release()},this.update=function(){for(var a=b.fingers,c=1;c<a.length;c++)a[c].update()}}},{"../Dummy.js":10,"../HandDesign.js":13,"./RightIndex.js":21,"./RightMiddle.js":22,"./RightPinky.js":23,"./RightRing.js":24,"./RightThumb.js":25}],21:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.RightIndex=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.indexFingerWidth,a.indexFingerHeight,a.indexFingerLength),d=new THREE.MeshLambertMaterial({color:a.indexFingerColor}),e=new THREE.Vector3(0,.2,.4);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=2;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 4:this.ringRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){a>f.get(c,c+4)&&a<f.get(c,c+8)||this.moveToNote(d-5)},this.ringRules=function(a,b,c,d){a>f.get(c,c+3)&&a<f.get(c,c+7)||this.moveToNote(d-3)},this.middleRules=function(a,b,c,d){a>f.get(c,c+2)&&a<f.get(c,c+5)||this.moveToNote(d-2)},this.thumbRules=function(a,b,c,d){if(!(a>f.get(c,c-3)&&0>a))if(a>0&&a<f.get(c,c+3)){var e=this;setTimeout(e.moveToNote(d+2),100)}else this.moveToNote(d+2)}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],22:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.RightMiddle=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.middleFingerWidth,a.middleFingerHeight,a.middleFingerLength),d=new THREE.MeshLambertMaterial({color:a.middleFingerColor}),e=new THREE.Vector3(0,.2,.4);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=3;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 4:this.ringRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){a>=f.get(c,c+3)&&a<=f.get(c,c+5)||this.moveToNote(d-3)},this.ringRules=function(a,b,c,d){a>=f.get(c,c+1)&&a<=f.get(c,c+4)||this.moveToNote(d-2)},this.indexRules=function(a,b,c,d){a>=f.get(c,c-3)&&a<=f.get(c,c-1)||this.moveToNote(d+2)},this.thumbRules=function(a,b,c,d){if(!(a>=f.get(c,c-6)&&0>a))if(a>0&&a<f.get(c,c+4)){var e=this;setTimeout(e.moveToNote(d+3),100)}else this.moveToNote(d+3)}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],23:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.RightPinky=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.pinkyWidth,a.pinkyHeight,a.pinkyLength),d=new THREE.MeshLambertMaterial({color:a.pinkyColor}),e=new THREE.Vector3(0,.2,.54);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=5;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.ringRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.ringRules=function(a,b,c,d){a>f.get(c,c-3)&&0>a||this.moveToNote(d+2)},this.middleRules=function(a,b,c,d){a>f.get(c,c-5)&&0>a||this.moveToNote(d+3)},this.indexRules=function(a,b,c,d){a>f.get(c,c-7)&&0>a||this.moveToNote(d+5)},this.thumbRules=function(a,b,c,d){if(!(a>f.get(c,c-12)&&0>a))if(a>0&&a<f.get(c,c+1)){var e=this;setTimeout(e.moveToNote(d+7),100)}else this.moveToNote(d+7)},this.setUpNewTween=function(){var a=this,b=function(){a.model.position.x=a.currentPos.x,a.model.position.y=a.currentPos.y+.1,a.model.position.z=a.currentPos.z+.1},c=TWEEN.Easing.Quadratic.Out,d=new TWEEN.Tween(this.currentPos).to(this.newPos,150).easing(c).onUpdate(b);d.start()}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],24:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.RightRing=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.ringFingerWidth,a.ringFingerHeight,a.ringFingerLength),d=new THREE.MeshLambertMaterial({color:a.ringFingerColor}),e=new THREE.Vector3(0,.2,.45);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=4;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c);break;case 1:this.thumbRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){a>f.get(c,c+2)&&a<f.get(c,c+3)||this.moveToNote(d-2)},this.middleRules=function(a,b,c,d){a>f.get(c,c-3)&&0>a||this.moveToNote(d+2)},this.indexRules=function(a,b,c,d){a>f.get(c,c-5)&&0>a||this.moveToNote(d+3)},this.thumbRules=function(a,b,c,d){if(!(a>f.get(c,c-8)&&0>a))if(a>0&&a<f.get(c,c+2)){var e=this;setTimeout(e.moveToNote(d+5),100)}else this.moveToNote(d+5)}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],25:[function(a,b){var c=a("../Finger.js").Finger,d=b.exports.RightThumb=function(a){c.call(this,a.keyboard);var b=new THREE.CubeGeometry(a.thumbWidth,a.thumbHeight,a.thumbLength),d=new THREE.MeshLambertMaterial({color:a.thumbColor}),e=new THREE.Vector3(0,.3,.6);this.model=new THREE.Mesh(b,d),this.model.position.copy(e),this.originalY=e.y,this.number=1;var f=this.distances;this.moveAsNeeded=function(a,b,c){var d=this.currentPos.x,e=b-d,f=this.model.currentNote;switch(a){case 5:this.pinkyRules(e,d,f,c);break;case 4:this.ringRules(e,d,f,c);break;case 3:this.middleRules(e,d,f,c);break;case 2:this.indexRules(e,d,f,c)}},this.pinkyRules=function(a,b,c,d){if(!(a>=f.get(c,c+5)&&a<f.get(c,c+12)))if(a>=f.get(c,c-2)&&0>a){var e=this;setTimeout(e.moveToNote(d-7),100)}else this.moveToNote(d-7)},this.ringRules=function(a,b,c,d){if(!(a>=f.get(c,c+4)&&a<=f.get(c,c+9)))if(a>f.get(c,c-2)&&0>a){var e=this;setTimeout(e.moveToNote(d-5),100)}else this.moveToNote(d-5)},this.middleRules=function(a,b,c,d){if(!(a>=f.get(c,c+2)&&a<=f.get(c,c+7)))if(a>f.get(c,c-3)&&0>a){var e=this;setTimeout(e.moveToNote(d-4),100)}else this.moveToNote(d-4)},this.indexRules=function(a,b,c,d){if(!(a>0&&a<=f.get(c,c+4)))if(a>f.get(c,c-2)&&0>a){var e=this;setTimeout(e.moveToNote(d-2),100)}else this.moveToNote(d-2)},this.setUpNewTween=function(){var a=this,b=function(){a.model.position.x=a.currentPos.x,a.model.position.y=a.currentPos.y+.1,a.model.position.z=a.currentPos.z+.2},c=TWEEN.Easing.Quadratic.Out,d=new TWEEN.Tween(this.currentPos).to(this.newPos,150).easing(c).onUpdate(b);d.start()}};d.prototype=Object.create(c.prototype),d.prototype.constructor=d},{"../Finger.js":11}],26:[function(a,b){var c=a("./PianoKey.js").PianoKey;b.exports.Keyboard=function(a){this.model=new THREE.Object3D,this.keys=[];for(var b=this,d=0;d<a.keyInfo.length;d++){var e=new c(a,d);b.keys.push(e),d>20&&109>d&&this.model.add(e.model)}this.model.position.y-=a.whiteKeyHeight/2,this.model.traverse(function(a){a.position.x-=4.45}),this.press=function(a){b.keys[a].press()},this.release=function(a){b.keys[a].release()},this.update=function(){for(var a=this,b=a.keys,c=0;c<b.length;c++)b[c].update()}}},{"./PianoKey.js":28}],27:[function(a,b){b.exports.KeyboardDesign=function(){this.KeyType={WhiteC:0,WhiteD:1,WhiteE:2,WhiteF:3,WhiteG:4,WhiteA:5,WhiteB:6,Black:7},this.whiteKeyStep=.236,this.whiteKeyWidth=.226,this.whiteKeyHeight=.22,this.whiteKeyLength=1.5,this.blackKeyWidth=.1,this.blackKeyHeight=.24,this.blackKeyLength=1,this.blackKeyShiftCDE=.0216,this.blackKeyShiftFGAB=.034,this.blackKeyPosY=.1,this.blackKeyPosZ=-.24,this.noteDropPosZ4WhiteKey=.25,this.noteDropPosZ4BlackKey=.75,this.whiteKeyColor=15794175,this.blackKeyColor=0,this.keyDip=.08,this.keyUpSpeed=.03,this.keyInfo=[];
var a=this,b=function(){c(),d(),e()},c=function(){for(var b=0;120>b;b++){var c={};a.keyInfo.push(c)}},d=function(){for(var b=a.KeyType,c=a.keyInfo,d=0;10>d;d++){var e=12*d;c[e+0].keyType=b.WhiteC,c[e+1].keyType=b.Black,c[e+2].keyType=b.WhiteD,c[e+3].keyType=b.Black,c[e+4].keyType=b.WhiteE,c[e+5].keyType=b.WhiteF,c[e+6].keyType=b.Black,c[e+7].keyType=b.WhiteG,c[e+8].keyType=b.Black,c[e+9].keyType=b.WhiteA,c[e+10].keyType=b.Black,c[e+11].keyType=b.WhiteD}},e=function(){var b=a.keyInfo,c=a.KeyType,d=c.WhiteB,e=0,f=0,g=c.Black;for(b[e].keyCenterPosX=f,d=b[e].keyType,e=1;e<b.length;e++)f+=d===g?a.whiteKeyStep/2:b[e].keyType===g?a.whiteKeyStep/2:a.whiteKeyStep,b[e].keyCenterPosX=f,d=b[e].keyType};b()}},{}],28:[function(a,b){var c=b.exports.PianoKey=function(a,b){{var c,d,e,f=a.KeyType.Black,g=a.keyInfo[b].keyType,h=a.keyInfo[b].keyCenterPosX;a.keyUpSpeed}g===f?(c=new THREE.CubeGeometry(a.blackKeyWidth,a.blackKeyHeight,a.blackKeyLength),d=new THREE.MeshPhongMaterial({color:a.blackKeyColor}),e=new THREE.Vector3(h,a.blackKeyPosY,a.blackKeyPosZ),this.originalColor={r:0,g:0,b:0}):(c=new THREE.CubeGeometry(a.whiteKeyWidth,a.whiteKeyHeight,a.whiteKeyLength),d=new THREE.MeshPhongMaterial({color:a.whiteKeyColor,emissive:1118481}),e=new THREE.Vector3(h,a.whiteKeyPosY,a.whiteKeyPosZ),this.originalColor={r:.941,g:1,b:1}),this.model=new THREE.Mesh(c,d),this.model.position.copy(e),this.keyUpSpeed=a.keyUpSpeed,this.originalY=e.y,this.pressedY=this.originalY-a.keyDip,this.newColor={r:0,g:0,b:0},this.currentColor={r:this.originalColor.r,g:this.originalColor.g,b:this.originalColor.b}};c.prototype.press=function(){this.model.position.y=this.pressedY,this.newColor={r:.145,g:.749,b:.854},this.setUpNewTween(),this.isPressed=!0},c.prototype.release=function(){this.isPressed=!1,this.newColor=this.originalColor,this.setUpNewTween()},c.prototype.update=function(){if(this.model.position.y<this.originalY&&this.isPressed===!1){var a=this.originalY-this.model.position.y;this.model.position.y+=Math.min(a,this.keyUpSpeed)}},c.prototype.setUpNewTween=function(){var a=this,b=function(){a.model.material.color.setRGB(a.currentColor.r,a.currentColor.g,a.currentColor.b)},c=TWEEN.Easing.Quadratic.Out,d=new TWEEN.Tween(this.currentColor).to(this.newColor,150).easing(c).onUpdate(b);d.start()}},{}],29:[function(a,b){b.exports.Scene=function(a){var b=$(a),c=b.width(),d=b.height(),e=this,f=new THREE.Scene,g=c/-200,h=c/200,i=d/200,j=d/-200,k=.001,l=1e3,m=new THREE.OrthographicCamera(g,h,i,j,k,l);m.position.set(0,3,1.2),m.lookAt(new THREE.Vector3(10,50,5));var n=new THREE.TrackballControls(m);n.rotateSpeed=1,n.zoomSpeed=1.2,n.panSpeed=.8,n.noZoom=!1,n.noPan=!1,n.staticMoving=!0,n.dynamicDampingFactor=.3,n.keys=[65,83,68];var o=Detector.webgl?new THREE.WebGLRenderer({antialias:!0}):new THREE.CanvasRenderer;o.setSize(c,d),o.setClearColor(0,1),o.autoClear=!1,b.append(o.domElement);var p=new THREE.AmbientLight(2236962),q=new THREE.DirectionalLight(16777215,.8);q.position.set(1,2,4).normalize();var r=new THREE.DirectionalLight(16777215,.3);r.position.set(-4,-1,-2).normalize,f.add(p),f.add(q),f.add(r),f.add(m),this.camera=m,this.renderer=o,this.scene=f,this.add=function(a){f.add(a)},this.animate=function(a){requestAnimationFrame(function(){e.animate(a)}),"function"==typeof a&&a(),n.update(),e.renderer.render(e.scene,e.camera)}}},{}]},{},[8]);